import{a5 as q,$ as J,a6 as Q,w as S,g,k as ee,n as P,R as O,u as E,r as i,a7 as te,a8 as D,a9 as oe,aa as ne,ab as R,c as B,d as L,ac as N,b as m,T as Y,ad as ae,i as K,ae as M,af as $,l as j,e as _,W as se,M as le,o as ce,ag as re,ah as ie,ai as ue,a3 as de,aj as ve,m as fe,ak as me,I as ye,al as he,Y as Ie}from"./index-9960dca2.js";function Ce(e,{args:t=[],done:o,canceled:a}){if(e){const n=e.apply(null,t);q(n)?n.then(l=>{l?o():a&&a()}).catch(J):n?o():a&&a()}else o()}const X=Symbol();function Ae(e){const t=Q(X,null);t&&S(t,o=>{o&&e()})}function H(e){const t=ee();t&&g(t.proxy,e)}const V={show:Boolean,zIndex:P,overlay:O,duration:P,teleport:[String,Object],lockScroll:O,lazyRender:O,beforeClose:Function,overlayStyle:Object,overlayClass:E,transitionAppear:Boolean,closeOnClickOverlay:O},Ee=Object.keys(V);function Oe(e,t){return e>t?"horizontal":t>e?"vertical":""}function pe(){const e=i(0),t=i(0),o=i(0),a=i(0),n=i(0),l=i(0),s=i(""),r=()=>s.value==="vertical",p=()=>s.value==="horizontal",y=()=>{o.value=0,a.value=0,n.value=0,l.value=0,s.value=""};return{move:v=>{const d=v.touches[0];o.value=(d.clientX<0?0:d.clientX)-e.value,a.value=d.clientY-t.value,n.value=Math.abs(o.value),l.value=Math.abs(a.value);const I=10;(!s.value||n.value<I&&l.value<I)&&(s.value=Oe(n.value,l.value))},start:v=>{y(),e.value=v.touches[0].clientX,t.value=v.touches[0].clientY},reset:y,startX:e,startY:t,deltaX:o,deltaY:a,offsetX:n,offsetY:l,direction:s,isVertical:r,isHorizontal:p}}let b=0;const T="van-overflow-hidden";function be(e,t){const o=pe(),a="01",n="10",l=u=>{o.move(u);const h=o.deltaY.value>0?n:a,v=ne(u.target,e.value),{scrollHeight:d,offsetHeight:I,scrollTop:k}=v;let C="11";k===0?C=I>=d?"00":"01":k+I>=d&&(C="10"),C!=="11"&&o.isVertical()&&!(parseInt(C,2)&parseInt(h,2))&&R(u,!0)},s=()=>{document.addEventListener("touchstart",o.start),document.addEventListener("touchmove",l,{passive:!1}),b||document.body.classList.add(T),b++},r=()=>{b&&(document.removeEventListener("touchstart",o.start),document.removeEventListener("touchmove",l),b--,b||document.body.classList.remove(T))},p=()=>t()&&s(),y=()=>t()&&r();te(p),D(y),oe(y),S(t,u=>{u?s():r()})}function F(e){const t=i(!1);return S(e,o=>{o&&(t.value=o)},{immediate:!0}),o=>()=>t.value?o():null}const[ke,we]=B("overlay"),Pe={show:Boolean,zIndex:P,duration:P,className:E,lockScroll:O,lazyRender:O,customStyle:Object};var Se=L({name:ke,props:Pe,setup(e,{slots:t}){const o=i(),a=F(()=>e.show||!e.lazyRender),n=s=>{e.lockScroll&&R(s,!0)},l=a(()=>{var s;const r=g(ae(e.zIndex),e.customStyle);return K(e.duration)&&(r.animationDuration=`${e.duration}s`),M(m("div",{ref:o,style:r,class:[we(),e.className]},[(s=t.default)==null?void 0:s.call(t)]),[[$,e.show]])});return N("touchmove",n,{target:o}),()=>m(Y,{name:"van-fade",appear:!0},{default:l})}});const ge=j(Se),xe=g({},V,{round:Boolean,position:_("center"),closeIcon:_("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:_("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[_e,A]=B("popup");var ze=L({name:_e,inheritAttrs:!1,props:xe,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:o,slots:a}){let n,l;const s=i(),r=i(),p=F(()=>e.show||!e.lazyRender),y=se(()=>{const c={zIndex:s.value};if(K(e.duration)){const f=e.position==="center"?"animationDuration":"transitionDuration";c[f]=`${e.duration}s`}return c}),u=()=>{n||(n=!0,s.value=e.zIndex!==void 0?+e.zIndex:ve(),t("open"))},h=()=>{n&&Ce(e.beforeClose,{done(){n=!1,t("close"),t("update:show",!1)}})},v=c=>{t("clickOverlay",c),e.closeOnClickOverlay&&h()},d=()=>{if(e.overlay)return m(ge,{show:e.show,class:e.overlayClass,zIndex:s.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:v},{default:a["overlay-content"]})},I=c=>{t("clickCloseIcon",c),h()},k=()=>{if(e.closeable)return m(ye,{role:"button",tabindex:0,name:e.closeIcon,class:[A("close-icon",e.closeIconPosition),me],classPrefix:e.iconPrefix,onClick:I},null)},C=()=>t("opened"),G=()=>t("closed"),U=c=>t("keydown",c),W=p(()=>{var c;const{round:f,position:w,safeAreaInsetTop:x,safeAreaInsetBottom:Z}=e;return M(m("div",fe({ref:r,style:y.value,role:"dialog",tabindex:0,class:[A({round:f,[w]:w}),{"van-safe-area-top":x,"van-safe-area-bottom":Z}],onKeydown:U},o),[(c=a.default)==null?void 0:c.call(a),k()]),[[$,e.show]])}),z=()=>{const{position:c,transition:f,transitionAppear:w}=e,x=c==="center"?"van-fade":`van-popup-slide-${c}`;return m(Y,{name:f||x,appear:w,onAfterEnter:C,onAfterLeave:G},{default:W})};return S(()=>e.show,c=>{c&&!n&&(u(),o.tabindex===0&&le(()=>{var f;(f=r.value)==null||f.focus()})),!c&&n&&(n=!1,t("close"))}),H({popupRef:r}),be(r,()=>e.show&&e.lockScroll),N("popstate",()=>{e.closeOnPopstate&&(h(),l=!1)}),ce(()=>{e.show&&u()}),re(()=>{l&&(t("update:show",!0),l=!1)}),D(()=>{e.show&&e.teleport&&(h(),l=!0)}),ie(X,()=>e.show),()=>e.teleport?m(ue,{to:e.teleport},{default:()=>[d(),z()]}):m(de,null,[d(),z()])}});const De=j(ze);function Re(){const e=Ie({show:!1}),t=n=>{e.show=n},o=n=>{g(e,n,{transitionAppear:!0}),t(!0)},a=()=>t(!1);return H({open:o,close:a,toggle:t}),{open:o,close:a,state:e,toggle:t}}function Be(e){const t=he(e),o=document.createElement("div");return document.body.appendChild(o),{instance:t.mount(o),unmount(){t.unmount(),document.body.removeChild(o)}}}const Le=(e,t)=>{const o=e.__vccOpts||e;for(const[a,n]of t)o[a]=n;return o};export{De as P,Le as _,H as a,Ee as b,Ce as c,Be as m,Ae as o,V as p,Re as u};
